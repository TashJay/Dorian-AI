<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ThinkAI</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
--bg-start: #d8f8e8;
--bg-end: #ffffff;
--primary-text: #052e16; /* A very dark green */
--secondary-text: #3f6252;
--accent-color: #40e090;
--suggestion-bg: rgba(230, 245, 237, 0.8);
--input-bg: rgba(255, 255, 255, 0.9);
}

body {
font-family: 'Inter', sans-serif;
background: radial-gradient(circle at 50% 0%, var(--bg-start) 0%, var(--bg-end) 80%);
color: var(--primary-text);
}

/* Main app container for responsiveness */
#app-container {
height: 100vh; /* Full height on mobile */
background-color: rgba(255, 255, 255, 0.4);
backdrop-filter: blur(30px);
border: 1px solid rgba(255, 255, 255, 0.6);
}

@media (min-width: 768px) { /* Tablet and Desktop */
#app-container {
max-width: 420px; /* Constrain width on larger screens */
height: 85vh;
max-height: 800px;
border-radius: 2.5rem; /* Rounded corners */
box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
}
}

/* Glossy orb avatar style */
.glossy-orb {
width: 90px;
height: 90px;
border-radius: 50%;
background: radial-gradient(circle at 30% 30%, #aaffd0, var(--accent-color));
box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12),
inset 0 4px 6px rgba(255, 255, 255, 0.6),
inset 0 -5px 10px rgba(0, 0, 0, 0.1);
}

/* Custom prompt suggestion buttons */
.prompt-button {
background-color: var(--suggestion-bg);
border: 1px solid rgba(255, 255, 255, 0.9);
transition: all 0.2s ease-in-out;
}
.prompt-button:hover {
transform: translateY(-2px);
box-shadow: 0 4px 15px rgba(0,0,0,0.08);
}

/* Chat bubble styles for the new theme */
.chat-bubble {
max-width: 85%;
padding: 12px 18px;
border-radius: 20px;
word-wrap: break-word;
animation: fadeIn 0.3s ease-out;
}
.chat-bubble-user {
background-color: #e0f2fe; /* Light blue */
color: #1a202c;
border-bottom-right-radius: 8px;
}
.chat-bubble-ai {
background-color: #f3f4f6; /* Light gray */
color: #1f2937;
border-bottom-left-radius: 8px;
}

@keyframes fadeIn {
from { opacity: 0; transform: translateY(10px); }
to { opacity: 1; transform: translateY(0); }
}

/* Custom Scrollbar */
.custom-scrollbar::-webkit-scrollbar { width: 6px; }
.custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
.custom-scrollbar::-webkit-scrollbar-thumb { background: #b8d8c8; border-radius: 3px; }
.custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #a0c0b0; }

/* Onboarding modal from original file (kept for functionality) */
.onboarding-step {
transition: opacity 0.6s ease-in-out, transform 0.6s ease-in-out;
}
.hidden-step {
opacity: 0;
transform: translateY(30px);
position: absolute;
pointer-events: none;
visibility: hidden;
}
</style>
</head>
<body class="w-screen h-screen overflow-hidden">

<div id="onboarding-modal" class="absolute inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4">
<div class="relative max-w-lg w-full">
<div id="onboarding-step-1" class="onboarding-step text-center p-6 md:p-8 bg-gray-900 rounded-3xl shadow-2xl">
<h1 class="text-4xl md:text-5xl font-extrabold text-white mb-3 md:mb-4 tracking-tight">Welcome to ThinkAI</h1>
<p class="text-lg md:text-xl text-blue-200 mb-6 font-light">Your AI-Powered Assistant</p>
<button onclick="nextOnboardingStep(1)" class="bg-blue-500 text-white font-bold py-3 px-8 rounded-full hover:bg-blue-600 w-full text-lg">Get Started</button>
</div>
<div id="onboarding-step-2" class="onboarding-step hidden hidden-step text-center p-6 md:p-8 bg-gray-900 rounded-3xl shadow-2xl">
<h2 class="text-2xl md:text-3xl font-bold text-white mb-4">Important Disclaimer</h2>
<p class="text-sm md:text-md text-blue-300 mb-6 p-4 bg-gray-800 rounded-lg border border-blue-700 leading-relaxed">
This is an AI assistant designed for informational purposes. It is <strong>not a substitute for professional advice.</strong> Always verify critical information.
</p>
<button onclick="finishOnboarding()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-full w-full text-lg">I Understand & Begin</button>
</div>
</div>
</div>

<div id="app-wrapper" class="flex justify-center items-center w-full h-full p-0 md:p-4">
<main id="app-container" class="relative w-full flex flex-col transition-all duration-300">

<header id="app-header" class="flex justify-between items-center p-5 z-10">
<div class="flex items-center gap-2">
<svg class="w-6 h-6 text-gray-700" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.471 6.63437C19.3875 6.55167 19.2905 6.48398 19.1844 6.43437C18.9438 6.32187 18.675 6.26562 18.4 6.26562H12.6V4.31562C12.6 3.36562 11.8312 2.59687 10.8812 2.59687H6C4.9 2.59687 4 3.49687 4 4.59687V19.3969C4 20.4969 4.9 21.3969 6 21.3969H18C19.1 21.3969 20 20.4969 20 19.3969V8.26562C20 7.61562 19.8031 7.02812 19.471 6.63437ZM18 20H6C5.6 20 5.4 19.8 5.4 19.4V4.6C5.4 4.2 5.6 4 6 4H10.9V8.2C10.9 9.2 11.7 10 12.7 10H18.6C18.8 10 19 9.8 19 9.6V19.4C18.8 19.8 18.6 20 18 20Z" fill="currentColor"/></svg>
<h1 class="font-bold text-lg text-gray-800">ThinkAI</h1>
</div>
<div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center font-bold text-gray-600 text-sm">M</div>
</header>

<div id="welcome-screen" class="flex flex-col items-center justify-center text-center p-6 flex-grow">
<div class="glossy-orb mb-6"></div>
<h2 class="text-2xl font-bold mb-2" style="color: var(--primary-text);">Good evening.</h2>
<h2 class="text-2xl font-semibold mb-3" style="color: var(--primary-text);">Can I help you with anything?</h2>
<p class="text-sm font-normal max-w-xs" style="color: var(--secondary-text);">
Choose a prompt below or write your own to start chatting with ThinkAI.
</p>
<div class="grid grid-cols-2 gap-3 mt-8 w-full max-w-sm">
<button class="prompt-button p-3 rounded-xl text-sm font-medium text-left" style="color: var(--primary-text);">Rewrite message for maximum impact</button>
<button class="prompt-button p-3 rounded-xl text-sm font-medium text-left" style="color: var(--primary-text);">Brainstorm creative ideas</button>
</div>
</div>

<div id="chat-screen" class="hidden flex-col flex-grow overflow-hidden">
<div id="chat-log" class="flex-1 p-6 space-y-4 overflow-y-auto custom-scrollbar">
</div>
</div>

<footer id="input-area" class="p-4 mt-auto z-10">
<form id="chat-form" class="relative flex items-center">
<textarea id="chat-input" class="w-full bg-[var(--input-bg)] text-gray-800 rounded-2xl p-4 pr-12 resize-none border border-gray-200 focus:outline-none focus:ring-2 focus:ring-green-300 placeholder-gray-500" placeholder="How can ThinkAI help you today?" rows="1" required></textarea>
<button type="submit" class="absolute right-3 top-1/2 -translate-y-1/2 p-2 rounded-full bg-green-500 text-white hover:bg-green-600 transition-colors">
<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 1.414L10.586 9H7a1 1 0 100 2h3.586l-1.293 1.293a1 1 0 101.414 1.414l3-3a1 1 0 000-1.414z" clip-rule="evenodd" /></svg>
</button>
</form>
<p class="text-center text-xs text-gray-500 mt-2">Please double-check responses.</p>
</footer>
</main>
</div>

<script>
// --- Gemini API Key (from original file) ---
const geminiApiKey = "YOUR_API_KEY_HERE"; // IMPORTANT: Replace with your actual Gemini API key

// --- Element References ---
const onboardingModal = document.getElementById('onboarding-modal');
const welcomeScreen = document.getElementById('welcome-screen');
const chatScreen = document.getElementById('chat-screen');
const chatLog = document.getElementById('chat-log');
const chatForm = document.getElementById('chat-form');
const chatInput = document.getElementById('chat-input');

let chatHistory = [];
let isFirstMessage = true;

// --- Onboarding Logic (from original file, simplified) ---
window.nextOnboardingStep = (step) => {
const currentStepDiv = document.getElementById(`onboarding-step-${step}`);
const nextStepDiv = document.getElementById(`onboarding-step-${step + 1}`);

currentStepDiv.classList.add('hidden-step');
setTimeout(() => {
currentStepDiv.classList.add('hidden');
if (nextStepDiv) {
nextStepDiv.classList.remove('hidden');
setTimeout(() => nextStepDiv.classList.remove('hidden-step'), 50);
}
}, 600);
};

window.finishOnboarding = () => {
onboardingModal.style.opacity = '0';
setTimeout(() => {
onboardingModal.classList.add('hidden');
}, 300);
};
// By default, hide onboarding to see the design. Remove the line below to enable it.
onboardingModal.classList.add('hidden');


// --- Chat Submission Logic ---
chatForm.addEventListener('submit', async (e) => {
e.preventDefault();
const userInput = chatInput.value.trim();
if (!userInput) return;

// On first message, switch from welcome screen to chat screen
if (isFirstMessage) {
welcomeScreen.classList.add('hidden');
chatScreen.classList.remove('hidden');
chatScreen.classList.add('flex'); // Make it a flex container
isFirstMessage = false;
}

addMessageToLog('user', userInput);
chatInput.value = '';
autoResizeTextarea(); // Reset height

// Add a temporary "thinking" bubble
const thinkingBubble = addMessageToLog('ai', '<span class="thinking-dots"><span>.</span><span>.</span><span>.</span></span>', true);

try {
chatHistory.push({ role: "user", parts: [{ text: userInput }] });
const payload = { contents: chatHistory };
const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent?key=${geminiApiKey}`;

const response = await fetch(apiUrl, {
method: 'POST',
headers: { 'Content-Type': 'application/json' },
body: JSON.stringify(payload)
});

if (!response.ok) {
const errorBody = await response.json();
throw new Error(errorBody.error.message || 'API request failed');
}

const result = await response.json();
let aiResponse = "Sorry, I couldn't generate a response. Please try again.";

if (result.candidates && result.candidates[0].content && result.candidates[0].content.parts.length > 0) {
aiResponse = result.candidates[0].content.parts[0].text;
}

// Update "thinking" bubble with the actual response
thinkingBubble.innerHTML = aiResponse.replace(/\n/g, '<br>');
chatHistory.push({ role: "model", parts: [{ text: aiResponse }] });
chatLog.scrollTop = chatLog.scrollHeight;


} catch (error) {
console.error("Gemini API Error:", error);
thinkingBubble.innerHTML = `Error: ${error.message}`;
thinkingBubble.style.backgroundColor = '#fee2e2'; // Red background for error
thinkingBubble.style.color = '#b91c1c';
}
});

function addMessageToLog(sender, text, isThinking = false) {
const messageDiv = document.createElement('div');
const bubble = document.createElement('div');

messageDiv.className = `flex ${sender === 'user' ? 'justify-end' : 'justify-start'}`;
bubble.className = `chat-bubble ${sender === 'user' ? 'chat-bubble-user' : 'chat-bubble-ai'}`;

if (isThinking) {
bubble.classList.add('thinking-bubble');
}

bubble.innerHTML = text.replace(/\n/g, '<br>');
messageDiv.appendChild(bubble);
chatLog.appendChild(messageDiv);
chatLog.scrollTop = chatLog.scrollHeight;
return bubble; // Return the bubble element to update it later
}

// --- Textarea Auto-Resize ---
function autoResizeTextarea() {
chatInput.style.height = 'auto';
const scrollHeight = chatInput.scrollHeight;
const maxHeight = 120; // Max height for 4-5 lines
if (scrollHeight > maxHeight) {
chatInput.style.overflowY = 'auto';
chatInput.style.height = maxHeight + 'px';
} else {
chatInput.style.overflowY = 'hidden';
chatInput.style.height = scrollHeight + 'px';
}
}
chatInput.addEventListener('input', autoResizeTextarea);

// --- Style for thinking animation ---
const style = document.createElement('style');
style.innerHTML = `
.thinking-dots span {
animation: blink 1.4s infinite both;
font-size: 1.5rem;
font-weight: bold;
}
.thinking-dots span:nth-child(2) { animation-delay: .2s; }
.thinking-dots span:nth-child(3) { animation-delay: .4s; }
@keyframes blink { 0%, 80%, 100% { opacity: 0; } 40% { opacity: 1; } }
`;
document.head.appendChild(style);
</script>

</body>
</html>